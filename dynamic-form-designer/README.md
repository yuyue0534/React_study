# 低代码表单设计器平台

一款基于 React + Tailwind CSS v3 的企业级低代码表单设计器平台,支持拖拽设计、实时预览、导入导出、角色鉴权等核心功能。

## 技术栈

- **框架**: React 18.x (函数组件 + Hooks)
- **样式**: Tailwind CSS v3 (JIT 模式)
- **拖拽**: react-dnd 16.x
- **状态管理**: Zustand 4.x
- **路由**: React Router v6
- **构建工具**: Vite 5.x
- **工具库**: lodash, nanoid, clsx

## 核心功能

### 1. 表单设计
- ✅ 拖拽添加组件/容器到画布
- ✅ 支持容器嵌套(行容器、列容器、分组容器)
- ✅ 8种基础表单组件(输入框、下拉框、日期选择等)
- ✅ 实时属性编辑,所见即所得
- ✅ 组件选中、删除、排序

### 2. 表单预览
- ✅ 切换预览模式查看最终效果
- ✅ 支持表单填写交互
- ✅ 模拟真实表单运行状态

### 3. 导入导出
- ✅ 导出表单为JSON文件
- ✅ 导入本地JSON表单
- ✅ 数据格式校验
- ✅ 导入前确认覆盖

### 4. 角色鉴权
- ✅ 三种用户角色(超级管理员、设计编辑者、仅预览者)
- ✅ 功能级权限控制
- ✅ 路由级权限拦截
- ✅ 角色切换测试

### 5. 数据持久化
- ✅ 本地存储(localStorage)
- ✅ 自动保存表单结构
- ✅ 手动保存功能
- ✅ 刷新页面不丢失数据

## 项目结构

```
form-designer/
├── src/
│   ├── components/          # 公共组件
│   │   ├── containers/      # 容器组件(Row/Column/Group)
│   │   ├── form/            # 表单组件(Input/Select等)
│   │   ├── layout/          # 布局组件(Header/Panel/Canvas)
│   │   ├── renderer/        # 渲染器组件
│   │   └── ui/              # UI组件(Button/Modal/Toast)
│   ├── constants/           # 常量配置
│   ├── hooks/               # 自定义Hooks
│   ├── pages/               # 页面组件
│   ├── stores/              # Zustand状态管理
│   ├── utils/               # 工具函数
│   ├── App.jsx              # 根组件
│   ├── main.jsx             # 入口文件
│   └── index.css            # 全局样式
├── public/                  # 静态资源
├── package.json             # 依赖配置
├── vite.config.js           # Vite配置
├── tailwind.config.js       # Tailwind配置
└── README.md                # 项目文档
```

## 快速开始

### 环境准备

确保已安装以下环境:
- Node.js >= 18.0.0
- npm/yarn/pnpm (推荐 pnpm)

### 安装依赖

```bash
# 使用 npm
npm install

# 使用 yarn
yarn install

# 使用 pnpm (推荐)
pnpm install
```

### 启动开发服务器

```bash
# 使用 npm
npm run dev

# 使用 yarn
yarn dev

# 使用 pnpm
pnpm dev
```

启动后,浏览器会自动打开 http://localhost:3000

### 构建生产版本

```bash
# 使用 npm
npm run build

# 使用 yarn
yarn build

# 使用 pnpm
pnpm build
```

构建后的文件在 `dist/` 目录下。

### 预览生产版本

```bash
# 使用 npm
npm run preview

# 使用 yarn
yarn preview

# 使用 pnpm
pnpm preview
```

## 使用指南

### 1. 设计表单

1. 从左侧组件库拖拽组件到画布
2. 点击选中组件,在右侧编辑属性
3. 使用容器组件实现复杂布局
4. 实时查看效果

### 2. 预览表单

1. 点击顶部"预览"按钮
2. 查看表单最终效果
3. 测试表单填写交互
4. 点击"返回设计"继续编辑

### 3. 保存表单

- 自动保存: 修改后自动保存到本地
- 手动保存: 点击顶部"保存"按钮

### 4. 导出表单

1. 点击顶部"导出"按钮
2. 自动下载JSON文件
3. 文件名格式: `表单名称_年月日_时分.json`

### 5. 导入表单

1. 点击顶部"导入"按钮
2. 选择本地JSON文件
3. 确认覆盖当前表单
4. 导入成功后自动加载

### 6. 角色切换

1. 点击顶部用户角色按钮
2. 选择要切换的角色
3. 系统自动调整权限
4. 测试不同角色的功能权限

## 角色权限说明

### 超级管理员
- ✅ 设计表单
- ✅ 编辑表单
- ✅ 预览表单
- ✅ 保存表单
- ✅ 导入表单
- ✅ 导出表单
- ✅ 切换角色

### 设计编辑者
- ✅ 设计表单
- ✅ 编辑表单
- ✅ 预览表单
- ✅ 保存表单
- ❌ 导入表单
- ❌ 导出表单
- ✅ 切换角色

### 仅预览者
- ❌ 设计表单
- ❌ 编辑表单
- ✅ 预览表单
- ❌ 保存表单
- ❌ 导入表单
- ❌ 导出表单
- ✅ 切换角色

## 组件说明

### 容器组件

#### 行容器 (Row)
- 水平排列子组件
- 可调整间距、对齐方式
- 支持嵌套其他组件/容器

#### 列容器 (Column)
- 垂直排列子组件
- 可调整间距、对齐方式
- 支持嵌套其他组件/容器

#### 分组容器 (Group)
- 带标题的分组容器
- 支持折叠/展开
- 适合组织相关表单项

### 基础组件

#### 单行输入框
- 单行文本输入
- 支持必填、禁用、最大长度

#### 多行输入框
- 多行文本输入
- 可调整行数
- 支持必填、禁用、最大长度

#### 下拉选择框
- 单选下拉
- 自定义选项
- 支持必填、禁用

#### 日期选择器
- 日期选择
- 标准日期格式
- 支持必填、禁用

#### 复选框
- 多选
- 自定义选项
- 支持必填、禁用

#### 单选框组
- 单选
- 自定义选项
- 支持必填、禁用

#### 按钮
- 操作按钮
- 多种样式
- 支持禁用

#### 文本标签
- 静态文本展示
- 可调整字体、颜色

## 常见问题

### Q1: 依赖安装失败

**解决方案**:
```bash
# 清除缓存
rm -rf node_modules package-lock.json

# 重新安装
npm install
```

### Q2: 启动报错

**解决方案**:
1. 检查 Node.js 版本 (>= 18.0.0)
2. 检查端口是否被占用 (默认3000)
3. 清除缓存后重新安装依赖

### Q3: 拖拽功能异常

**解决方案**:
1. 确保 react-dnd 版本正确
2. 检查浏览器兼容性
3. 刷新页面重试

### Q4: 导入导出失败

**解决方案**:
1. 检查JSON文件格式是否正确
2. 确保当前角色有相应权限
3. 查看浏览器控制台错误信息

### Q5: 本地存储丢失

**解决方案**:
1. 检查浏览器localStorage是否可用
2. 避免使用隐私/无痕模式
3. 定期导出表单备份

## 后续迭代建议

### 功能扩展

1. **表单联动**
   - 组件间数据联动
   - 条件显示/隐藏
   - 动态校验规则

2. **数据校验**
   - 正则表达式校验
   - 自定义校验规则
   - 实时校验提示

3. **模板库**
   - 预置表单模板
   - 模板分类管理
   - 一键应用模板

4. **主题定制**
   - 亮色/暗黑模式
   - 自定义主题色
   - 组件样式预设

### 性能优化

1. **组件懒加载**
   - 按需加载组件
   - 减少首屏加载时间

2. **大数据渲染优化**
   - 虚拟列表
   - 分页加载
   - 性能监控

3. **代码分割**
   - 路由级代码分割
   - 组件级动态导入

## 技术支持

如有问题或建议,请通过以下方式联系:

- 提交 Issue
- 发送邮件
- 技术文档

## 开源协议

MIT License

---

**版本**: v1.0.0  
**更新日期**: 2025-02-01  
**作者**: Claude AI
